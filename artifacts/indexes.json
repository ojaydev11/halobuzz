{
  "critical_missing_indexes": [
    {
      "model": "User",
      "index": "{ email: 1, status: 1, banned: 1 }",
      "priority": "HIGH",
      "impact": "Authentication performance",
      "estimated_performance_gain": "70%"
    },
    {
      "model": "User",
      "index": "{ username: 1, status: 1, banned: 1 }",
      "priority": "HIGH",
      "impact": "Username login performance",
      "estimated_performance_gain": "70%"
    },
    {
      "model": "Transaction",
      "index": "{ userId: 1, status: 1, createdAt: -1 }",
      "priority": "CRITICAL",
      "impact": "Financial queries, balance calculations",
      "estimated_performance_gain": "80%"
    },
    {
      "model": "Transaction",
      "index": "{ \"metadata.orderId\": 1 }",
      "unique": true,
      "sparse": true,
      "priority": "CRITICAL",
      "impact": "Payment idempotency, data integrity",
      "estimated_performance_gain": "N/A - Prevents corruption"
    },
    {
      "model": "LiveStream",
      "index": "{ status: 1, category: 1, \"location.country\": 1, currentViewers: -1 }",
      "priority": "HIGH",
      "impact": "Stream discovery and ranking",
      "estimated_performance_gain": "85%"
    },
    {
      "model": "LiveStream",
      "index": "{ status: 1, totalGiftsValue: -1, currentViewers: -1 }",
      "priority": "HIGH",
      "impact": "Trending streams calculation",
      "estimated_performance_gain": "75%"
    },
    {
      "model": "Message",
      "index": "{ conversationId: 1, createdAt: -1 }",
      "priority": "HIGH",
      "impact": "Chat message loading",
      "estimated_performance_gain": "90%"
    },
    {
      "model": "GameRound",
      "index": "{ playerId: 1, createdAt: -1 }",
      "priority": "CRITICAL",
      "impact": "Fraud detection, velocity checks",
      "estimated_performance_gain": "N/A - Security critical"
    }
  ],
  "ttl_configurations": [
    {
      "model": "Transaction",
      "ttl": {
        "field": "createdAt",
        "expireAfterSeconds": 2592000,
        "filter": "{ status: 'failed' }",
        "description": "Remove failed transactions after 30 days"
      }
    },
    {
      "model": "GameRound",
      "ttl": {
        "field": "createdAt",
        "expireAfterSeconds": 7776000,
        "description": "Remove completed game rounds after 90 days"
      }
    },
    {
      "model": "ModerationFlag",
      "ttl": {
        "field": "updatedAt",
        "expireAfterSeconds": 15552000,
        "filter": "{ status: 'resolved' }",
        "description": "Remove resolved moderation flags after 6 months"
      }
    },
    {
      "model": "ReputationEvent",
      "ttl": {
        "field": "createdAt",
        "expireAfterSeconds": 31536000,
        "description": "Remove old reputation events after 1 year"
      }
    }
  ],
  "performance_indexes": [
    {
      "model": "User",
      "index": "{ phoneNumber: 1 }",
      "sparse": true,
      "priority": "MEDIUM",
      "impact": "Phone login lookup"
    },
    {
      "model": "User",
      "index": "{ lastLoginAt: 1 }",
      "priority": "MEDIUM",
      "impact": "Session management, analytics"
    },
    {
      "model": "User",
      "index": "{ \"location.country\": 1, status: 1 }",
      "priority": "MEDIUM",
      "impact": "Geographic user analytics"
    },
    {
      "model": "Gift",
      "index": "{ category: 1, rarity: 1, active: 1 }",
      "priority": "MEDIUM",
      "impact": "Gift catalog browsing"
    },
    {
      "model": "Gift",
      "index": "{ priceInCoins: 1, active: 1 }",
      "priority": "MEDIUM",
      "impact": "Price-based gift filtering"
    },
    {
      "model": "Game",
      "index": "{ category: 1, active: 1, difficulty: 1 }",
      "priority": "LOW",
      "impact": "Game listing and filtering"
    },
    {
      "model": "ModerationFlag",
      "index": "{ status: 1, priority: 1, createdAt: 1 }",
      "priority": "MEDIUM",
      "impact": "Moderation workflow"
    },
    {
      "model": "WebhookEvent",
      "index": "{ provider: 1, processed: 1, createdAt: -1 }",
      "priority": "LOW",
      "impact": "Webhook processing monitoring"
    }
  ],
  "compound_indexes_analysis": {
    "total_missing": 16,
    "critical_missing": 8,
    "estimated_db_size_reduction": "40%",
    "estimated_query_performance_improvement": "60-90%",
    "implementation_effort_days": 3
  },
  "production_readiness": {
    "current_score": "6.5/10",
    "after_indexes": "8.5/10",
    "critical_blockers": [
      "Transaction atomicity",
      "Missing authentication indexes",
      "No TTL for temporary data",
      "Race condition vulnerabilities"
    ],
    "estimated_fix_time": "3-5 days for critical issues"
  }
}